<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redbooth Studios | Premium Beats</title>
    <!-- Essential Libraries -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://unpkg.com/wavesurfer.js@7"></script>

    <style>
        :root {
            --primary: #FF004C;
            --secondary: #00F2FF;
            --bg: #0b0b0b;
            --card-bg: #161616;
            --text: #ffffff;
            --text-dim: #a0a0a0;
            --whatsapp: #25D366;
            --youtube: #FF0000;
            --pad-m: 25px;
            --pad-s: 15px;
            --gap: 20px;
        }

        body {
            font-family: 'Inter', sans-serif;
            margin:0; padding:0;
            background: var(--bg);
            color: var(--text);
            scroll-behavior: smooth;
            padding-bottom: 140px; /* Space for the new player */
        }

        /* --- Header & Slider Labels --- */
        header {
            background: linear-gradient(135deg, #000, #1a0008, var(--primary));
            padding: 40px var(--pad-m);
            text-align: center;
            border-bottom: 3px solid var(--primary);
        }
        header h1 { margin: 0; font-size: clamp(1.8rem, 5vw, 3rem); text-transform: uppercase; letter-spacing: 3px; font-weight: 800; }
        .studio-tag { background: rgba(0,0,0,0.5); padding: 6px 15px; border-radius: 30px; display: inline-flex; align-items: center; gap: 10px; font-size: 0.8rem; margin-top: 12px; border: 1px solid #333; }
        .pulse { width: 8px; height: 8px; background: var(--secondary); border-radius: 50%; animation: pulse-glow 1.5s infinite; }
        @keyframes pulse-glow { 0% { opacity: 1; transform: scale(1); } 50% { opacity: 0.4; transform: scale(1.2); } 100% { opacity: 1; transform: scale(1); } }

        .slider-label { text-align: center; color: var(--secondary); font-weight: 800; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 2px; margin-top: 25px; }
        .slider-section { background: #000; padding: 15px 0; border-bottom: 1px solid #222; overflow: hidden; position: relative; }
        .marquee { display: flex; width: max-content; animation: marquee-scroll 40s linear infinite; align-items:center; }
        .marquee img { height: 65px; width: 65px; border-radius: 50%; margin: 0 15px; border: 2px solid var(--primary); object-fit: cover; }
        @keyframes marquee-scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        /* --- Navigation --- */
        nav { background: rgba(11,11,11,0.95); padding: var(--pad-s); position: sticky; top: 0; z-index: 100; backdrop-filter: blur(15px); border-bottom: 1px solid #333; text-align: center; }
        #beat-search { width: 90%; max-width: 500px; padding: 10px 20px; border-radius: 25px; border: 1px solid #444; background: #1a1a1a; color: white; outline: none; font-size: 0.95rem; }

        /* --- Grid Layout --- */
        .main-layout { display: grid; grid-template-columns: 1fr; gap: var(--gap); max-width: 1300px; margin: auto; padding: var(--pad-m); }
        @media (min-width: 1024px) { .main-layout { grid-template-columns: 1fr 320px; gap: 30px; } }

        .genre-folder { margin-bottom: 15px; border: 1px solid #222; border-radius: 10px; overflow: hidden; background: #111; }
        .genre-header { background: #1a1a1a; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .genre-header h2 { margin: 0; font-size: 1rem; color: var(--primary); text-transform: uppercase; }
        .genre-content { display: none; padding: 20px; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 20px; }
        .genre-content.active { display: grid; }

        .media-card { background: var(--card-bg); padding: 20px; border-radius: 12px; border: 1px solid #222; }
        .play-btn { background: var(--primary); border: none; width: 42px; height: 42px; border-radius: 50%; color: white; cursor: pointer; display:inline-flex; align-items:center; justify-content:center; }

        /* --- Centered Bottom Features --- */
        .bottom-features { display: grid; grid-template-columns: 1fr; gap: var(--gap); margin-top: 25px; text-align: center; justify-content: center; max-width: 900px; margin-left: auto; margin-right: auto; }
        @media (min-width: 768px) { .bottom-features { grid-template-columns: 1fr 1fr; } }
        .feature-card { background: #111; padding: var(--pad-m); border-radius: 12px; border: 1px solid #222; }
        .feature-card h3 { color: var(--secondary); margin-top: 0; font-size: 1rem; text-transform: uppercase; }
        .contact-links { display: flex; justify-content: center; gap: 20px; margin-top: 15px; font-size: 1.6rem; }
        .contact-links a { color: var(--text); }

        /* --- Player Controls --- */
        #master-player {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 130px;
            background: rgba(0,0,0,0.95); border-top: 2px solid var(--secondary);
            display: none; flex-direction: column; padding: 10px 25px; z-index: 1000; box-sizing: border-box;
            backdrop-filter: blur(10px);
        }
        #waveform-container { width: 100%; height: 50px; margin-bottom: 10px; cursor: pointer; }
        .player-flex { display: flex; align-items: center; justify-content: space-between; width: 100%; }

        /* --- Buttons & UI --- */
        .yt-premium-box { background: #111; padding: 20px; border-radius: 12px; text-align: center; border: 1px solid #333; margin-bottom: 20px; }
        .buy-btn { width: 100%; background: none; border: 1px solid var(--primary); padding: 10px; border-radius: 6px; color: var(--primary); cursor: pointer; font-weight: 800; margin-top: 10px; font-size: 0.85rem; transition: 0.3s; }
        .buy-btn:hover { background: var(--primary); color: white; }
        .checkout-now { background: var(--whatsapp); color: black; border: none; }

        /* --- Modals & Multi-step --- */
        #payment-modal, #auth-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; align-items: center; justify-content: center; }
        .modal-content { background: var(--card-bg); padding: 30px; border-radius: 15px; width: 90%; max-width: 380px; text-align: center; border: 2px solid var(--secondary); }
        .m-input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #444; background: #000; color: white; text-align: center; box-sizing: border-box; }

        .loading-ring { width: 40px; height: 40px; border: 4px solid var(--secondary); border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<header>
    <h1>Redbooth Studios</h1>
    <div class="studio-tag"><div class="pulse"></div> <span style="color: var(--secondary);">PRODUCED BY STEVE CHRISS MW</span></div>
</header>

<div class="slider-label">Our beats were used by:</div>
<div class="slider-section">
    <div class="marquee" id="artist-slider"></div>
</div>

<nav><input type="text" id="beat-search" placeholder="Search Trap, Afrobeat, Drill..." oninput="handleSearch()"></nav>

<div class="main-layout">
    <section>
        <div id="beats-container"></div>
        <div class="bottom-features">
            <div class="feature-card">
                <h3>Contact Us</h3>
                <div class="contact-links">
                    <a href="mailto:redboothstudios1@gmail.com"><i class="fas fa-envelope"></i></a>
                    <a href="https://wa.me/265887347767" target="_blank"><i class="fab fa-whatsapp"></i></a>
                    <a href="https://www.instagram.com/steve-chriss-mw.instagram/" target="_blank"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <div class="feature-card">
                <h3>VIP Services</h3>
                <p id="vip-status-text" style="font-size:0.75rem; color:var(--text-dim);">Register to unlock stems and bonuses.</p>
                <div style="display:flex; gap:10px;" id="auth-box">
                    <button class="buy-btn" style="flex:1;" onclick="openAuth('signin')">SIGN IN</button>
                    <button class="buy-btn" style="flex:1; border-color:var(--secondary); color:var(--secondary);" onclick="openAuth('register')">REGISTER</button>
                </div>
            </div>
        </div>
    </section>

    <aside>
        <div class="yt-premium-box">
            <h3 style="color:var(--secondary); font-size: 1rem;">FREE BEATS</h3>
            <a href="https://www.youtube.com/@stevechrissmw?sub_confirmation=1" target="_blank" class="buy-btn" style="text-decoration:none; display:block; background:#fff; color:#000; border:none;">SUBSCRIBE</a>
        </div>
        <div class="yt-premium-box">
            <h3 style="font-size: 1rem;">YOUR CART</h3>
            <div id="cart-list" style="text-align:left; max-height: 180px; overflow-y: auto; font-size: 0.85rem;"></div>
            <div id="cart-total" style="font-size:1.5rem; color:var(--secondary); margin:10px 0; font-weight: 800;">K0</div>
            <button class="buy-btn checkout-now" onclick="checkout()">CHECKOUT</button>
        </div>
    </aside>
</div>

<!-- --- NEW LIVE WAVEFORM PLAYER --- -->
<div id="master-player">
    <div id="waveform-container"></div>
    <div class="player-flex">
        <div style="display:flex; align-items:center; gap:12px; width:220px;">
            <button class="play-btn" id="m-btn" onclick="toggleM()"><i class="fas fa-play"></i></button>
            <div id="m-name" style="font-weight:800; font-size:0.85rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Beat Name</div>
        </div>
        <div id="m-time" style="font-size: 0.75rem; color: var(--secondary);">0:00 / 0:00</div>
        <div style="width:100px;"><input type="range" min="0" max="1" step="0.1" value="0.8" oninput="ws.setVolume(this.value)" style="accent-color:var(--secondary); width:100%;"></div>
    </div>
</div>

<!-- --- MODALS --- -->
<div id="auth-modal">
    <div class="modal-content">
        <div id="auth-loading" style="display:none">
            <div class="loading-ring"></div>
            <p id="auth-msg">Sending VIP confirmation email...</p>
        </div>
        <div id="auth-form">
            <h2 id="auth-title" style="color:var(--secondary); margin-top:0;">VIP Access</h2>
            <input type="email" id="auth-email" class="m-input" placeholder="Email Address">
            <input type="password" id="auth-pass" class="m-input" placeholder="Password">
            <button class="buy-btn checkout-now" onclick="handleAuthSubmit()">PROCEED</button>
            <button class="buy-btn" style="border:none; color:var(--text-dim);" onclick="closeAuthModal()">Cancel</button>
        </div>
    </div>
</div>

<div id="payment-modal">
    <div class="modal-content">
        <div id="pay-step-1">
            <h2 style="color:var(--secondary); margin-top:0;">Mobile Money</h2>
            <select id="network-type" class="m-input"><option value="airtel">Airtel Money</option><option value="tnm">TNM Mpamba</option></select>
            <input type="tel" id="user-phone" class="m-input" placeholder="099 / 088..." maxlength="10">
            <button class="buy-btn checkout-now" onclick="goToStep2()">PAY NOW</button>
            <button class="buy-btn" style="border:none; color:var(--text-dim);" onclick="closePayment()">Cancel</button>
        </div>
        <div id="pay-step-2" style="display:none;">
            <h2 style="color:var(--whatsapp);">Awaiting PIN</h2>
            <div class="loading-ring"></div>
            <p style="font-size:0.8rem;">Please enter your Mobile Money PIN on your phone to complete the purchase of <span id="final-total" style="color:var(--secondary)">K0</span>.</p>
            <button class="buy-btn" style="border:none; color:var(--primary);" onclick="closePayment()">Cancel Transaction</button>
        </div>
    </div>
</div>

<script>
// --- INITIALIZE LIVE PLAYER ---
const ws = WaveSurfer.create({
    container: '#waveform-container',
    waveColor: '#333',
    progressColor: '#FF004C',
    cursorColor: '#00F2FF',
    barWidth: 2,
    height: 50,
    responsive: true
});

ws.on('audioprocess', () => {
    document.getElementById('m-time').innerText = fmt(ws.getCurrentTime()) + " / " + fmt(ws.getDuration());
});

// --- FULL DATA RESTORE ---
const beatsData = {
    "Trap": [
        { id: 101, name: "Around", price: 10000, file: "audio/trap/Around.mp3" },
        { id: 102, name: "Attributes Sky", price: 10000, file: "audio/trap/Attributes_Sky.mp3" },
        { id: 103, name: "Awareness", price: 10000, file: "audio/trap/Awareness.mp3" },
        { id: 104, name: "Galaxy", price: 10000, file: "audio/trap/Galaxy.mp3" },
        { id: 105, name: "Not Again", price: 10000, file: "audio/trap/Not_Again.mp3" },
        { id: 106, name: "Nueva", price: 10000, file: "audio/trap/Nueva.mp3" },
        { id: 107, name: "Rappers Choice", price: 10000, file: "audio/trap/Rappers_Choice.mp3" },
        { id: 108, name: "Space", price: 10000, file: "audio/trap/Space.mp3" },
        { id: 109, name: "To Ghettoh", price: 10000, file: "audio/trap/To_Ghettoh.mp3" },
        { id: 110, name: "Twilightlight", price: 10000, file: "audio/trap/Twightlight.mp3" }
    ],
    "Drill": [{ id: 2, name: "Storm Drill", price: 12000, file: "audio/drill/Storm.mp3" }],
    "Afrobeat": [{ id: 3, name: "Lagos Night", price: 15000, file: "audio/afro/Lagos.mp3" }],
    "Dancehall": [{ id: 4, name: "Island Riddim", price: 10000, file: "audio/dance/Island.mp3" }],
    "Hip Hop": [{ id: 5, name: "Legendary", price: 12000, file: "audio/hiphop/Legend.mp3" }],
    "EDM": [{ id: 6, name: "Neon Lights", price: 15000, file: "audio/edm/Neon.mp3" }],
    "Pop": [{ id: 7, name: "Radio Star", price: 13000, file: "audio/pop/Star.mp3" }],
    "Amapiano": [{ id: 8, name: "Piano Vibes", price: 15000, file: "audio/amapiano/Vibes.mp3" }],
    "Kwaito": [{ id: 9, name: "Summer Days", price: 10000, file: "audio/kwaito/Summer.mp3" }],
    "UK-Afro": [{ id: 10, name: "London Vibe", price: 12000, file: "audio/ukafro/London.mp3" }]
};

let cart = [], currentId = null, currentAuthMode = 'signin';

function init() {
    const slider = document.getElementById('artist-slider');
    const artists = [1,2,3,4,5,6,7,8];
    slider.innerHTML = artists.map(i => `<img src="artists/artist${i}.jpg">`).join('') + artists.map(i => `<img src="artists/artist${i}.jpg">`).join('');
    renderBeats();
}

function renderBeats() {
    const container = document.getElementById('beats-container');
    const query = document.getElementById('beat-search').value.toLowerCase();
    container.innerHTML = '';
    Object.keys(beatsData).sort().forEach(genre => {
        const filtered = beatsData[genre].filter(b => b.name.toLowerCase().includes(query));
        if (filtered.length > 0) {
            const folder = document.createElement('div');
            folder.className = 'genre-folder';
            folder.innerHTML = `<div class="genre-header" onclick="this.nextElementSibling.classList.toggle('active')"><h2>${genre}</h2><i class="fas fa-chevron-down"></i></div>
            <div class="genre-content">${filtered.map(b => `
                <div class="media-card">
                    <h3 style="margin-top:0; font-size: 1rem;">${b.name}</h3>
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <button class="play-btn" onclick="playB('${b.file}', '${b.name}', ${b.id})"><i class="fas fa-play" id="icon-${b.id}"></i></button>
                        <span style="font-weight:800; color:var(--secondary)">K${b.price.toLocaleString()}</span>
                    </div>
                    <button class="buy-btn" onclick="addC(${b.id},'${b.name}',${b.price})">ADD TO CART</button>
                </div>`).join('')}</div>`;
            container.appendChild(folder);
        }
    });
}

function playB(file, name, id) {
    if (currentId === id) { toggleM(); return; }
    document.querySelectorAll('.play-btn .fas').forEach(i => i.className = 'fas fa-play');

    currentId = id;
    document.getElementById('master-player').style.display = 'flex';
    document.getElementById('m-name').innerText = name;
    document.getElementById('m-btn').innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

    ws.load(file);
    ws.on('ready', () => {
        ws.play();
        document.getElementById('m-btn').innerHTML = '<i class="fas fa-pause"></i>';
        document.getElementById(`icon-${id}`).className = 'fas fa-pause';
    });
}

function toggleM() {
    ws.playPause();
    const isPlaying = ws.isPlaying();
    document.getElementById('m-btn').innerHTML = isPlaying ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>';
    if(currentId) document.getElementById(`icon-${currentId}`).className = isPlaying ? 'fas fa-pause' : 'fas fa-play';
}

function fmt(s) { if(!isFinite(s)) return '0:00'; let m=Math.floor(s/60), r=Math.floor(s%60); return `${m}:${r<10?'0':''}${r}`; }

// --- AUTH LOGIC ---
function openAuth(mode) {
    currentAuthMode = mode;
    document.getElementById('auth-modal').style.display = 'flex';
    document.getElementById('auth-title').innerText = mode === 'signin' ? 'VIP Sign In' : 'VIP Registration';
}
function closeAuthModal() { document.getElementById('auth-modal').style.display = 'none'; document.getElementById('auth-loading').style.display = 'none'; document.getElementById('auth-form').style.display = 'block'; }

function handleAuthSubmit() {
    const email = document.getElementById('auth-email').value;
    if(!email) return alert("Please enter email");

    document.getElementById('auth-form').style.display = 'none';
    document.getElementById('auth-loading').style.display = 'block';
    document.getElementById('auth-msg').innerText = currentAuthMode === 'register' ? "Sending welcome email to " + email : "Verifying VIP status...";

    setTimeout(() => {
        alert(currentAuthMode === 'register' ? "Success! A verification email has been sent to " + email + ". You can now access VIP services." : "Sign In Successful!");
        document.getElementById('vip-status-text').innerText = "VIP STATUS: ACTIVE";
        document.getElementById('vip-status-text').style.color = "var(--secondary)";
        document.getElementById('auth-box').innerHTML = `<p style="color:var(--whatsapp)">Welcome back!</p>`;
        closeAuthModal();
    }, 2500);
}

// --- CART & PAYMENT ---
function addC(id, n, p) { if(!cart.find(i => i.n === n)) { cart.push({n, p}); renderC(); } else { alert("Already in cart"); } }
function renderC() {
    document.getElementById('cart-list').innerHTML = cart.map((i, idx) => `<div style="display:flex; justify-content:space-between; margin-bottom:5px;"><span>${i.n}</span><i class="fas fa-trash" onclick="removeFromCart(${idx})" style="color:red; cursor:pointer"></i></div>`).join('');
    const total = cart.reduce((a,b)=>a+b.p,0).toLocaleString();
    document.getElementById('cart-total').innerText = "K" + total;
    document.getElementById('final-total').innerText = "K" + total;
}
function removeFromCart(index) { cart.splice(index, 1); renderC(); }

function checkout() { if (cart.length === 0) return alert("Your cart is empty!"); document.getElementById('payment-modal').style.display = 'flex'; }
function closePayment() {
    document.getElementById('payment-modal').style.display = 'none';
    document.getElementById('pay-step-1').style.display = 'block';
    document.getElementById('pay-step-2').style.display = 'none';
}
function goToStep2() {
    if(document.getElementById('user-phone').value.length < 10) return alert("Invalid Number");
    document.getElementById('pay-step-1').style.display = 'none';
    document.getElementById('pay-step-2').style.display = 'block';
}

function handleSearch() { renderBeats(); }
window.onload = init;
</script>
</body>
</html>
